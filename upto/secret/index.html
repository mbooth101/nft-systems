<!DOCTYPE html>
<html>
<!--
Oi, there's nothing to see here!
Go on, off ya feck, ya nosey bastard!
-->
<head>
	<link rel="stylesheet" href="../../styles.css" />
</head>
<body class="nft">
	<a href="../../" title="Back to Intranet Home Page"><img class="seal" src="../../seal.png" alt="Company Seal"/></a>
	<div>
	<h1>Nerdfighteria UPTO (Unpaid Paid Time Off) Denial System</h1>
	<p><strong>NOTE:</strong> THIS PAGE IS FOR SEA-LEVEL EMPLOYEES ONLY.</p>
	<p class="status">UNAUTHORISED USE OF THIS PAGE WILL RESULT IN IMMEDIATE DISMISSAL, DISMISTERAL OR DISENBYAL!</p>
	<h2>Pending Requests</h2>
	<ul id="pending">
		<li><em>Loading...</em></li>
	</ul>
	<small>(c) NFT Inc. 1994-1999 | Best viewed on Internet Explorer 5 or Netscape Navigator 4</small>
	</div>
<script type="module">
	// Import the functions you need from the SDKs you need
	import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
	import { getDatabase, ref, onValue, increment, update, push, set } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

	// Your web app's Firebase configuration
	const firebaseConfig = {
		apiKey: "AIzaSyCblJjEwi2iseqSShfYCnhgORKDoHklkuM",
		authDomain: "nft-systems.firebaseapp.com",
		databaseURL: "https://nft-systems-default-rtdb.europe-west1.firebasedatabase.app",
		projectId: "nft-systems",
		storageBucket: "nft-systems.appspot.com",
		messagingSenderId: "127549558739",
		appId: "1:127549558739:web:c4f4dc58b52b30d548e926"
	};

	// Initialize Firebase Realtime Database
	const app = initializeApp(firebaseConfig);
	const db = getDatabase(app);

	const pendingRef = ref(db, 'upto/pending');
	const approvedRef= ref(db, 'upto/approved');
	const deniedRef = ref(db, 'upto/denied');
	onValue(pendingRef, (snapshot) => {
		let reqs = document.getElementById('pending');
		reqs.replaceChildren();
		if (snapshot.val() != null) {
			snapshot.forEach((childSnapshot) => {
				const data = childSnapshot.val();
				reqs.appendChild(createEntry(childSnapshot.key, childSnapshot.val()));
			});
		} else {
			let entry = document.createElement("li");
			entry.appendChild(document.createTextNode("None, yet."));
			reqs.appendChild(entry);
		}
	});

	function createEntry(key, data) {
		let entry = document.createElement('li');
		let reason = data.reason;
		if (data.reason == "Other" || data.reason == "Food Coma (Other)" ) {
			reason = reason + " (" + data.reason_other + ")";
		}
		let req = data.user + " requested " + data.start + " to " + data.end + " (" + data.days + " days) due to \"" + reason + "\"";
		entry.appendChild(document.createTextNode(req));
		entry.appendChild(document.createElement('br'));
		entry.appendChild(document.createTextNode("Details: "));
		let emph = document.createElement('em');
		emph.appendChild(document.createTextNode(data.deets));
		entry.appendChild(emph);
		return entry;
	}
</script>
</body>
</html>
